<div id="main-content-footer-container">
	<div class="footer-container" id="main-reward-footer-left">
		<div class="back-btn-container">
			<button class="button" type="button" name="back-button" onclick="navigateBackToOrderPage()">BACK</button>
		</div>
	</div>

<div class="footer-container" id="main-reward-footer-left2">
		<div id="MealDeal-container">
			<button class="button" type="button" name="insert-mealDeal" onclick="addDeal()">add-mealDeal</button>
	
	<script>
	datenow = new date().getTime();

	</script>
	</div>
	<form id="main-reward-footer-left2mod" onsubmit="return false">

			<label for="dealID">dealID:</label>
			<input id="dealID" type="text" name="dealID" placeholder="dealID">{{ dealID if dealID }}</input><br>
			

			<label for="name">name:</label>
			<input id="name" type="text" name="name" placeholder="navn">{{ name if name}}</input><br>
			

			<label for="price">price:</label>
			<input id="price" type="text" name="price" placeholder="pris" min="0">{{ price if price }}</input><br>
			

			<label for="startDate">startDate:</label>
			<input id="startDate" type="date" name="startDate" placeholder="yyyy-mm-dd" required>{{ startDate if startDate else datenow }}</input><br>
			

			<label for="endDate">endDate:</label>
			<input id="endDate" type="date" name="endDate" placeholder="yyyy-mm-dd" required>{{ endDate if endDate else datenow }}</input><br>
			

			<label for="courses">courses:</label>
			<input id="courses" type="text" name="courses" placeholder="courses">{{ courses if courses}}</input><br>

			<label for="items">items:</label>
			<input id="items" type="text" name="items" placeholder="# of items">{{ "#"}}</input><br>
			</form>
<script>
		function addDeal() {
			let dealID = parseInt(document.getElementById("dealID").value, 10);
			let name = parseInt(document.getElementById("name").value, 10);
			let price = parseInt(document.getElementById("price").value, 10);
			let startDate = parseInt(document.getElementById("startDate").value, 10);
			let endDate = parseInt(document.getElementById("endDate").value, 10);
			let courses = parseInt(document.getElementById("courses").value, 10);
			let items = parseInt(document.getElementById("items").value, 10);

			const http = new XMLHttpRequest();
			const url = '/reward-pages/id?method=post';
			http.open('POST', url);
			http.setRequestHeader('Content-type', 'application/json; charset=utf-8');

			let json = JSON.parse('{}');
			json.dealID = dealID;
			json.nameID = nameID;
			json.price = price;
			json.startDate = startDate;
			json.endDate = endDate;
			json.courses = courses;

			http.send(JSON.stringify(json));
			http.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					window.location.href = '/reward-pages/id?method=post';
				}
			}
		}
	</script>
	</div>

	<div class="footer-container" id="main-reward-footer-middle">
		<form id="main-reward-footer-modifier" onsubmit="return false">
			<script>
//redundant?
			function updateCouponView(){
				let id = document.getElementById("coupon").id;
				let json = Get("reward/coupon/:{{id}}")
				let couponID = parseInt(json.couponID, 10); 
				let expirationDate = parse(json.expirationDate, 10);
				let couponType = parseInt(json.type, 10);
				let couponValue = parseInt(json.value, 10);
				
				coupon.id = couponID;
				coupon.expirationDate = expirationDate;
				coupon.type = couponType;
				coupon.value = couponValue;
				e.couponID = couponID;
				e.expirationDate = expirationDate;
				e.type = couponType;
				e.value = couponValue;
			}

			function updateCoupons(){
				let id = document.getElementById("user").value;
				var xmlHttp = new XMLHttpRequest();
				xmlHttp.open( "GET", "reward-pages/{{id}}?page=coupons", false ); // false for synchronous request
				xmlHttp.send( null );
				let userCoupons = xmlHttp.responseText;
				//coupons for loop?
				let coupons = [integer];
				 coupons = parseInt(userCoupons.coupons, 10);

				 let selectCoupon = document.getElementById("selectCoupon");
				 selectCoupon.value = coupons(1);
			}

			function updateMealDeals(){
				//let id = document.getElementById("user").value;
				let json = Get('reward-pages/page=MealDeal');
				let dealID = parseInt(json.dealID);
				let price = parseInt(json.price);
				let name = parse(json.name);
				let startDate = parse(json.startDate);
				let endDate = parse(json.endDate);
				let courses = [{}||{}];
				 courses = parse(json.courses);
				 d.dealID = dealID;
				 d.price = price;
				 d.name = name;
				 d.startDate = startDate;
				 d.endDate = endDate;
				 d.courses = courses;
			}



			function Get(theUrl){
				var xmlHttp = new XMLHttpRequest();
				xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
				xmlHttp.send( null );
				return xmlHttp.responseText;
			}

		</script>
			<label for="user">User:</label>
			<input id="user" onchange="updateCoupons()" type="text" name="user" placeholder="skriv brukerID"><br>

			<label for="selectCoupon">Velg kupong:</label>
			<select id="selectCoupon" name="selectCoupon" onload="" onchange="updateCouponView(); ">
				<option value="none||none" selected>No coupon</option>
				{% for coupon in coupons %}
				<option value="{{coupon.type}}||{{coupon.value}}">{{ coupon.value }}{{ "%" if coupon.type == 0 else "kr" }}</option>
				{% endfor %}
			</select><br>
			

			<label for="Ctype">type:</label>
			<select id="Ctype" type="text" name="type" placeholder="%"> {{ "%" if Ctype.value == 0 else "kr" }}
			<option value ="0" selected>0</option>
			<option value ="1" selected>1</option>
			 </select><br>

			<label for="Cvalue">value:</label>
			<input id="Cvalue" type="text" name="Cvalue" placeholder="verdi" min="0" max="100">{{ Cvalue if Cvalue}}</input><br>

			<label for="CexpirationDate">expirationDate:</label>
			<input id="CexpirationDate" type="date" name="CexpirationDate" placeholder="skriv inn dato">{{ CexpirationDate if CexpirationDate else datenow}}</input><br>
		</form>
	</div>

	<div class="footer-container" id="main-reward-footer-right">
		<div id="add-btn-container">
			<button class="button" type="button" name="add-button" onclick="addCoupon()">addCoupon</button>
		</div>
	</div>

	<script>
		function addCoupon() {
			let type = parseInt(document.getElementById("Ctype").value, 10);
			let value = parseInt(document.getElementById("Cvalue").value, 10);
			let expirationDate = parseInt(document.getElementById("CexpirationDate").value, 10);

			const http = new XMLHttpRequest();
			const url = 'reward-pages/page=coupon';
			http.open('POST', url);
			http.setRequestHeader('Content-type', 'application/json; charset=utf-8');

			let json = JSON.parse('{}');
			json.type = type;
			json.value = value;
			json.expirationDate = expirationDate;

			http.send(JSON.stringify(json));

			http.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					window.location.href = '/reward-pages/page=coupon'
					let nyeste = xmlHttp.responseText;
					newcoupon.value = nyeste.couponID;
				}
			}
		}
	</script>

	<div class="footer-container" id="main-reward-footer-right2">

	<label for="newUser">newUser:</label>
			<input id="newUser" type="text" name="newUser" placeholder="ny">{{ User if User}}</input><br>

	<label for="newCoupon">newCoupon:</label>
			<input id="newCoupon" type="text" name="newCoupon" placeholder="nyeste">{{ NewCoupon if NewCoupon}}</input><br>

		<div id="give-btn-container">
			<button class="button" type="button" name="give-button" onclick="giveCoupon()">giveCoupon</button>
		</div>

	</div>
	<script>
		function giveCoupon() {
			let userID = parseInt(document.getElementById("newUser").value, 10);
			let couponID = parseInt(document.getElementById("newCoupon").value, 10);

			const http = new XMLHttpRequest();
			const url = '/reward-pages/page=user-coupons';
			http.open('PACTH', url);
			http.setRequestHeader('Content-type', 'application/json; charset=utf-8');

			let json = JSON.parse('{}');
			json.userID = userID;
			json.couponID = couponID;

			http.send(JSON.stringify(json));

			http.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					window.location.href = '/reward-pages/page=user-coupons'
					
				}
			}
		}
	</script>